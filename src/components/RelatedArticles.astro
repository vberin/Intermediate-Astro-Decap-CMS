---
// src/components/RelatedArticles.astro
import { getCollection } from 'astro:content';

// Props:
// - parentPillarId: ID текущей статьи-столпа.
// - allPosts: Полный список всех статей блога.
const { parentPillarId, allPosts } = Astro.props;

// Находим все кластерные статьи, которые ссылаются на текущую страницу-столп
const relatedClusters = allPosts.filter(post => post.data.parentPillar === parentPillarId);
---

{relatedClusters.length > 0 &&
    <aside class="related-articles">
        <h3 class="related-title">Содержание этого раздела:</h3>
        <ul class="related-list">
            {relatedClusters.map(post => (
                <li class="related-item">
                    <a href={`/blog/${post.id}/`} class="related-link">{post.data.title}</a>
                </li>
            ))}
        </ul>
    </aside>
}

<style lang="less">
.related-articles {
    width: 100%;
    margin-top: 3rem;
    margin-bottom: 2rem;
    padding: 2rem;
    background-color: #f7f7f7;
    border-left: 4px solid var(--primary);
    border-radius: 0 8px 8px 0;
}

.related-title {
    font-size: 1.5rem;
    font-weight: 700;
    margin-bottom: 1.5rem;
    color: var(--headerColor);
}

.related-list {
    list-style: none;
    padding: 0;
    margin: 0;
    display: flex;
    flex-direction: column;
    gap: 1rem;
}

.related-link {
    text-decoration: none;
    color: var(--secondary);
    font-weight: 500;
    transition: color 0.3s;

    &:hover {
        color: var(--primary);
        text-decoration: underline;
    }
}

/* Dark Mode */
body.dark-mode & {
    .related-articles {
        background-color: var(--accent);
        border-left-color: var(--primaryLight);
    }

    .related-title {
        color: var(--bodyTextColorWhite);
    }

    .related-link {
        color: #9dafe5; // Более светлый синий для темного фона

        &:hover {
            color: var(--primaryLight);
        }
    }
}
</style>
